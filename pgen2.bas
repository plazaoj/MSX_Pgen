10 REM ****SETUP*********
20 SCREEN 1:COLOR 15,4,4:KEYOFF
30 RESTORE240:D2=BASE(10):WD=23:HG=23
40 FOR I=0 TO 15:FOR J=0 TO 7
50 READ V: VPOKE I*8+J,V
60 NEXT J:NEXT I
70 SD=5
80 DEF FNRN(Q)=INT(16*RND(-Q*Q))
90 REM ****CREACION LABERINTO****
100 FOR I=0 TO HG-1:FOR J=0 TO WD-1
110 GOSUB 160
120 VPOKED2+I*32+J,Z
130 NEXT J:NEXT I
140 IF INKEY$="" THEN 140
150 END
160 S0=(I+1)*WD+(J+1)
170 Z=FNRN(SD+S0)
180 IF I<HG-1 THEN SU=(Z AND 4) ELSE SU=0
190 IF J<WD-1 THEN ES=(Z AND 2) ELSE ES=0
200 IF I=0 THEN NO=0 ELSE NO=(FNRN(SD+(S0-WD)) AND 4)/4
210 IF J=0 THEN OE=0 ELSE OE=4*(FNRN(SD+(S0-1)) AND 2)
220 Z=NO+ESTE+SUR+OESTE
230 RETURN
240 DATA &HFF,&H81,&H81,&H81,&H81,&H81,&H81,&HFF
250 DATA &H81,&H81,&H81,&H81,&H81,&H81,&H81,&HFF
260 DATA &HFF,&H80,&H80,&H80,&H80,&H80,&H80,&HFF
270 DATA &H80,&H80,&H80,&H80,&H80,&H80,&H80,&HFF
280 DATA &HFF,&H81,&H81,&H81,&H81,&H81,&H81,&H81
290 DATA &H81,&H81,&H81,&H81,&H81,&H81,&H81,&H81
300 DATA &HFF,&H80,&H80,&H80,&H80,&H80,&H80,&H80
310 DATA &H80,&H80,&H80,&H80,&H80,&H80,&H80,&H80
320 DATA &HFF,&H01,&H01,&H01,&H01,&H01,&H01,&HFF
330 DATA &H01,&H01,&H01,&H01,&H01,&H01,&H01,&HFF
340 DATA &HFF,&H00,&H00,&H00,&H00,&H00,&H00,&HFF
350 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&HFF
360 DATA &HFF,&H01,&H01,&H01,&H01,&H01,&H01,&H01
370 DATA &H01,&H01,&H01,&H01,&H01,&H01,&H01,&H01
380 DATA &HFF,&H00,&H00,&H00,&H00,&H00,&H00,&H00
390 DATA &H00,&H00,&H00,&H00,&H00,&H00,&H00,&H00
